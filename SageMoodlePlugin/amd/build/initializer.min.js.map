{"version":3,"file":"initializer.min.js","sources":["../src/initializer.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Initializes the Sage block, setting up necessary components and event listeners.\n * Checks for quiz attempt URL, checks Sage availability, and initializes chat,\n * error explanation, and focus tracking functionalities.\n *\n * @module     block_sage/initializer\n * @copyright  2025 Vasilevskiy Vladimir <vivasilevskiy_1@edu.hse.ru>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['block_sage/api/chat_api', 'block_sage/render/chat', 'block_sage/render/explain_error', 'core/ajax',\n        'block_sage/controller/focus_controller',\n        //'block_sage/controller/tick_controller',\n    ],\n    function (chat_api, chat, explain_error, Ajax, focus_controller, //tick_controller\n\n    ) {\n        return {\n            init: function () {\n                if (window.location.href.match(/attempt=(\\d+)/) === null) {\n                    return;\n                }\n                const request = Ajax.call([\n                    {\n                        methodname: 'block_sage_check_availability',\n                        args: {},\n                    },\n                ]);\n\n                request[0].done(function (response) {\n                    if (response.available) {\n                        chat.init();\n                        chat_api.syncMessagesFromServer();\n                        explain_error.init();\n                        focus_controller.init();\n                        //tick_controller.init();\n                    }\n                });\n                request[0].fail(function (e) {\n                    window.console.error(\"The sage API is temporary unavailable: \", e);\n                });\n            },\n        };\n    });"],"names":["define","chat_api","chat","explain_error","Ajax","focus_controller","init","window","location","href","match","request","call","methodname","args","done","response","available","syncMessagesFromServer","fail","e","console","error"],"mappings":";;;;;;;;;AAwBAA,gCAAO,CAAC,0BAA2B,yBAA0B,kCAAmC,YACxF,2CAGJ,SAAUC,SAAUC,KAAMC,cAAeC,KAAMC,wBAGpC,CACHC,KAAM,cACkD,OAAhDC,OAAOC,SAASC,KAAKC,MAAM,8BAGzBC,QAAUP,KAAKQ,KAAK,CACtB,CACIC,WAAY,gCACZC,KAAM,MAIdH,QAAQ,GAAGI,MAAK,SAAUC,UAClBA,SAASC,YACTf,KAAKI,OACLL,SAASiB,yBACTf,cAAcG,OACdD,iBAAiBC,WAIzBK,QAAQ,GAAGQ,MAAK,SAAUC,GACtBb,OAAOc,QAAQC,MAAM,0CAA2CF"}